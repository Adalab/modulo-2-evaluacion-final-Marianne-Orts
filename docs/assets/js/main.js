"use strict";const formElement=document.querySelector(".js-form"),inputElement=document.querySelector(".js-input"),btnElement=document.querySelector(".js-btn"),cardsElement=document.querySelector(".js-cards"),favouritesElement=document.querySelector(".js-favourite-cards");let series=[],arrayFavourites=[];function handleForm(e){e.preventDefault()}function getDataFromApi(e){fetch("https://api.tvmaze.com/search/shows?q="+e).then(e=>e.json()).then(e=>{series=[];for(const t of e){let e;e=null===t.show.image?"https://via.placeholder.com/210x295/ffffff/666666/?text=TV":t.show.image.medium;let r={id:t.show.id,name:t.show.name,image:e};series.push(r)}paintSeries(),setInLocalStorage(),paintFavouriteSeries()})}function setInLocalStorage(){const e=JSON.stringify(arrayFavourites);localStorage.setItem("favouriteSeries",e)}function getFromLocalStorage(){const e=localStorage.getItem("favouriteSeries");null!==e&&(arrayFavourites=JSON.parse(e),paintFavouriteSeries(arrayFavourites))}function handleBtn(){getDataFromApi(inputElement.value)}function paintSeries(){let e="";for(const t of series)e+='<li class="card__list">',e+=`<div class="card__list--item js-card" id="${t.id}">`,e+=`<h4>${t.name}</h4>`,e+=`<img class="card__list--img"\n        src="${t.image}"\n        title="${t.name}"\n        alt="${t.name}"/>`;e+="</div>",e+="</li>",cardsElement.innerHTML=e,listenSeriesEvents()}function paintFavouriteSeries(){let e="";e+='<button class="card__list--button-reset js-reset">Borrar todo</button>';for(const t of arrayFavourites)e+='<li class="section-favourites__cards">',e+=`<div class="section-favourites__cards--item" id="${t.id}">`,e+=`<h4>${t.name}</h4>`,e+=`<img class="section-favourites__cards--img"\n            src="${t.image}"\n            title="${t.name}"\n            alt="${t.name}"/>`,e+=`<i class="section-favourites__cards--button js-remove gg-trash" id="${t.id}"></i>`;e+="</div>",e+="</li>",favouritesElement.innerHTML=e,setInLocalStorage(),listenSeriesEvents(),listenFavouritesEvents()}function handleCard(e){const t=parseInt(e.currentTarget.id),r=arrayFavourites.findIndex(e=>e.id===t);if(-1===r)for(const e of series)e.id===t&&arrayFavourites.push(e);else arrayFavourites.splice(r,1);setInLocalStorage(),paintFavouriteSeries(),listenSeriesEvents()}function listenSeriesEvents(){const e=document.querySelectorAll(".js-card");for(const t of e)t.addEventListener("click",handleCard)}function handleRemove(e){const t=parseInt(e.currentTarget.id),r=arrayFavourites.findIndex(e=>e.id===t);arrayFavourites.splice(r,1),setInLocalStorage(),paintFavouriteSeries(),listenFavouritesEvents()}function handleReset(){arrayFavourites=[],setInLocalStorage(),paintFavouriteSeries(),listenFavouritesEvents()}function listenFavouritesEvents(){const e=document.querySelectorAll(".js-remove"),t=document.querySelector(".js-reset");for(const t of e)t.addEventListener("click",handleRemove);t.addEventListener("click",handleReset)}formElement.addEventListener("submit",handleForm),btnElement.addEventListener("click",handleBtn),getFromLocalStorage();